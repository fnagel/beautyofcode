{namespace boc=TYPO3\Beautyofcode\ViewHelpers}

<script type="text/javascript">
	<f:section name="Main">
		;(function ($) {
			var
				options = {

				<f:if condition="{settings.baseUrl}">
					baseUrl: '<boc:makeAbsolute url="{settings.baseUrl}" />',
				</f:if>

				<f:if condition="{settings.scripts}">
					scripts: '{settings.scripts}',
				</f:if>

				<f:if condition="{settings.styles}">
					styles: '{settings.styles}',
				</f:if>

				<f:if condition="{settings.theme}">
					theme: '{settings.theme}',
				</f:if>

				<f:if condition="{settings.defaults}">
					defaults: {
						<f:render section="Defaults" arguments="{ defaults: settings.defaults }" />
					},
				</f:if>

					config: {
						strings: {
							expandSource: '<f:translate id="config.strings.expandSource" default="show source" />',
							viewSource: '<f:translate id="config.strings.viewSource" default="view source" />',
							copyToClipboard: '<f:translate id="config.strings.copyToClipboard" default="copy to clipboard" />',
							copyToClipboardConfirmation: '<f:translate id="config.strings.copyToClipboardConfirmation" default="The code is in your clipboard now" />',
							print: '<f:translate id="config.strings.print" default="print" />',
							help: '<f:translate id="config.strings.help" default="?" />',
							alert: '<f:translate id="config.strings.alert" default="SyntaxHighlighter\n\n" />',
							noBrush: '<f:translate id="config.strings.noBrush" default="Can\'t find brush for: " />',
							brushNotHtmlScript: '<f:translate id="config.strings.brushNotHtmlScript" default="Brush wasn\'t configured for html-script option: " />'
						}
					},

				<f:if condition="{settings.selector}">
					ready: function() {
						$("{settings.selector} pre.code:has(code[class])").beautifyCode();
					},
				</f:if>

					brushes: [ "Plain"<f:render section="Brushes" /> ]
				};

			${settings.onReadyCallback}
				$.beautyOfCode.init(options);
			});
		})(jQuery);
	</f:section>

	<f:section name="Defaults">
		<f:for each="{defaults}" as="value" key="key" iteration="i">
			<f:if condition="{i.cycle} != 1">,</f:if>"{key}": {value}
		</f:for>
	</f:section>

	<f:section name="Brushes">
		<f:for each="{settings.brushes -> boc:explode(delimiter: ',', removeEmptyValues: 'TRUE')}" as="brush">, "{brush}"</f:for>
	</f:section>
</script>